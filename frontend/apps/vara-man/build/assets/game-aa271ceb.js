var X=Object.defineProperty;var Y=(h,e,t)=>e in h?X(h,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):h[e]=t;var a=(h,e,t)=>(Y(h,typeof e!="symbol"?e+"":e,t),t);import{r as d,f as I,j as i,b,c as S,P as Z,m as T,X as R,S as $,d as K,o as J}from"./index-48645c43.js";import{u as Q}from"./use-message-4865ca96.js";const L=60*10,k=d.createContext({silverCoins:0,goldCoins:0,incrementCoins:()=>{},lives:3,gameTime:L,level:"Easy"}),ee=({children:h})=>{const{player:e,game:t}=I(),n=e?Number(e.lives):3,s=t?t.level:"Easy",o=L,[r,l]=d.useState(0),[m,f]=d.useState(0),u=g=>{g==="silver"?l(p=>p+1):g==="gold"&&f(p=>p+1)};return i.jsx(k.Provider,{value:{silverCoins:r,goldCoins:m,incrementCoins:u,lives:n,gameTime:o,level:s},children:h})},te=[{icon:i.jsx(b.statsHeart,{className:"w-8 h-8"}),color:"[--stats-theme:#F95050]"},{icon:i.jsx(b.statsTimer,{className:"w-8 h-8"}),color:"[--stats-theme:#fff]"},{icon:i.jsx(b.statsCoinGold,{className:"w-8 h-8"}),color:"[--stats-theme:#FEB724]"},{icon:i.jsx(b.statsCoinSilver,{className:"w-8 h-8"}),color:"[--stats-theme:#B1C8D9]"}],ie=()=>i.jsxs("svg",{className:"absolute inset-0 -z-1 w-full h-full",width:"1120",height:"119",viewBox:"0 0 1120 119",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[i.jsx("path",{d:"M1.5 20C1.5 9.78273 9.78273 1.5 20 1.5H280H420H454.58C475.474 1.5 494.364 13.9359 502.622 33.1287L509.788 49.7824C518.42 69.842 538.162 82.8394 560 82.8394C581.838 82.8394 601.58 69.8419 610.212 49.7824L617.378 33.1287C625.636 13.9359 644.526 1.5 665.42 1.5H700H840H1100C1110.22 1.5 1118.5 9.78273 1118.5 20V117.5H1.5V20Z",fill:"url(#paint0_linear_171_3216327)",fillOpacity:"0.05",stroke:"url(#paint1_linear_171_3216327)",strokeWidth:"3"}),i.jsxs("defs",{children:[i.jsxs("linearGradient",{id:"paint0_linear_171_3216327",x1:"535.045",y1:"26.647",x2:"539.052",y2:"118.646",gradientUnits:"userSpaceOnUse",children:[i.jsx("stop",{stopColor:"#1DA88F"}),i.jsx("stop",{offset:"0.598958",stopColor:"#2B85E4"}),i.jsx("stop",{offset:"0.979167",stopColor:"#1E1E1E"})]}),i.jsxs("linearGradient",{id:"paint1_linear_171_3216327",x1:"867.95",y1:"-28.353",x2:"862.941",y2:"51.6459",gradientUnits:"userSpaceOnUse",children:[i.jsx("stop",{stopColor:"#2B86E3"}),i.jsx("stop",{offset:"0.609375",stopColor:"#16B768"}),i.jsx("stop",{offset:"1",stopColor:"#202831"})]})]})]}),y=({children:h,className:e,icon:t})=>i.jsxs("div",{className:S("flex items-center text-[var(--stats-theme)] font-semibold tracking-wider text-base leading-none",e),children:[i.jsx("div",{className:"relative z-1",children:t}),i.jsxs("div",{className:"relative flex items-center justify-center -ml-4 w-17.5 bg-white/[1%] shadow-[var(--stats-theme)] shadow-[inset_0_0_4px] h-6 pr-3 pl-6 rounded-r-full overflow-hidden",children:[h,i.jsx("span",{className:"absolute top-full -mt-0.5 w-2.5 h-2.5 rounded-full bg-[var(--stats-theme)] shadow-[0_0_10px_1px_var(--stats-theme)]"})]})]}),N=""+new URL("gold_coin-00edd41f.svg",import.meta.url).href,E=""+new URL("silver_coin-f0f81fe9.svg",import.meta.url).href,se=""+new URL("avarar-7bbbc030.svg",import.meta.url).href,ne="_player_ypaxx_1",ae="_first_ypaxx_10",oe="_second_ypaxx_13",re="_thirty_ypaxx_16",_={player:ne,first:ae,second:oe,thirty:re};function F({isOpen:h,setIsOpen:e,players:t,overlayCn:n,className:s}){const o=()=>e(r=>!r);return i.jsxs(Z,{isOpen:h,setIsOpen:e,overlayCn:n,className:s,title:"Champions",footer:i.jsx("div",{className:"pr-4 pl-8 pt-5 pb-8",children:i.jsxs("button",{className:S("btn font-kanit w-full space-x-2",T.light),onClick:o,children:[i.jsx(R,{className:"w-5 h-5 text-white/80"}),i.jsx("span",{className:"leading-4",children:"Close"})]})}),children:[i.jsx("div",{className:"font-kanit",children:i.jsxs("div",{className:"flex justify-between px-4 leading-6 text-xs tracking-[0.08em] uppercase text-white/60 bg-white/5 rounded-[20px]",children:[i.jsx("span",{children:"Player"}),i.jsx("span",{children:"Coins"})]})}),i.jsx($,{className:"mt-3 max-h-80 pr-4 -mr-4",type:"auto",children:t.map((r,l)=>{const{name:m,claimedGoldCoins:f,claimedSilverCoins:u}=r[1],g=[_.player,l===0&&_.first,l===1&&_.second,l===2&&_.thirty];return i.jsxs("div",{className:S(g),children:[i.jsx("img",{src:se,alt:"",className:"-m-[10px]"}),i.jsx("span",{className:"w-50 ml-5",children:m}),i.jsx("div",{className:"flex items-center justify-end",children:[{icon:N,value:f},{icon:E,value:u}].map((p,x)=>i.jsxs("div",{className:"flex items-center w-12",children:[i.jsx("img",{width:20,src:p.icon,alt:"",className:"mr-1"}),i.jsx("span",{children:p.value})]},x))})]},r[0])})})]})}function le({}){const[h,e]=d.useState(!1),{allPlayers:t}=I(),n=t?t.slice().sort((s,o)=>{const[r,l]=s,[m,f]=o,u=l.claimedGoldCoins+l.claimedSilverCoins;return f.claimedGoldCoins+f.claimedSilverCoins-u}):[];return i.jsxs(i.Fragment,{children:[i.jsx("button",{className:S("btn px-6",T.lightGreen),onClick:()=>e(s=>!s),children:"Show champions"}),t&&i.jsx(F,{setIsOpen:e,isOpen:h,players:n})]})}const ce=d.memo(le),he=""+new URL("stats-hero-fc3b2113.svg",import.meta.url).href,C=te;function me({}){const{account:h}=K(),{silverCoins:e,goldCoins:t,lives:n,gameTime:s}=d.useContext(k),[o,r]=d.useState("00:00"),[l,m]=d.useState(s);d.useEffect(()=>{r((p=>{const x=Math.floor(p/60),w=p%60,M=String(x).padStart(2,"0"),j=String(w).padStart(2,"0");return`${M}:${j}`})(l))},[l]),d.useEffect(()=>{const g=setInterval(()=>{m(p=>Math.max(p-1,0))},1e3);return()=>clearInterval(g)},[]);const u=h&&((g,p)=>{if(g.length<=p)return g;const x=g.slice(0,p/2),w=g.slice(-p/2);return x+"..."+w})(h.decodedAddress,10);return i.jsxs("div",{className:"relative font-kanit",children:[i.jsx(ie,{}),i.jsxs("div",{className:"flex items-center justify-between py-10 px-7.5",children:[i.jsxs("div",{className:"flex space-x-10",children:[i.jsx(ce,{}),i.jsxs("div",{className:"flex space-x-8",children:[i.jsx(y,{icon:C[0].icon,className:C[0].color,children:n}),i.jsx(y,{icon:C[1].icon,className:C[1].color,children:o})]})]}),i.jsxs("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 grid gap-4 text-center",children:[i.jsx("img",{width:92,height:92,src:he,alt:"Avatar"}),i.jsx("span",{className:"text-test",children:"Vara - Man"})]}),i.jsxs("div",{className:"flex space-x-10",children:[i.jsxs("div",{className:"flex space-x-8",children:[i.jsx(y,{icon:C[2].icon,className:C[2].color,children:t}),i.jsx(y,{icon:C[3].icon,className:C[3].color,children:e})]}),i.jsxs("div",{className:"btn bg-white/[1%] shadow-white shadow-[inset_0_0_4px] px-6 flex-col items-start pt-1 pb-1.5 cursor-auto",children:[i.jsx("small",{className:"text-white/60 opacity-80 font-normal text-[10px] leading-[14px]",children:"Substrate address"}),i.jsx("span",{className:"leading-4",children:u})]})]})]})]})}const c={up:0,down:1,left:2,right:3},D=""+new URL("tamagochi-bcf56bab.svg",import.meta.url).href;class de{constructor(e,t,n,s,o){a(this,"x");a(this,"y");a(this,"tileSize");a(this,"velocity");a(this,"tileMap");a(this,"currentMovingDirection");a(this,"requestedMovingDirection");a(this,"characterAnimationTimerDefault");a(this,"characterAnimationTimer");a(this,"characterRotation");a(this,"powerDotActive");a(this,"powerDotAboutToExpire");a(this,"timers");a(this,"madeFirstMove");a(this,"Rotation",c);a(this,"characterImages");a(this,"characterImageIndex");a(this,"CHARACTER_IMAGE_OFFSET_X",-10);a(this,"CHARACTER_IMAGE_OFFSET_Y",-15);a(this,"keydown",e=>{e.keyCode==38&&(this.currentMovingDirection==c.down&&(this.currentMovingDirection=c.up),this.requestedMovingDirection=c.up,this.madeFirstMove=!0),e.keyCode==40&&(this.currentMovingDirection==c.up&&(this.currentMovingDirection=c.down),this.requestedMovingDirection=c.down,this.madeFirstMove=!0),e.keyCode==37&&(this.currentMovingDirection==c.right&&(this.currentMovingDirection=c.left),this.requestedMovingDirection=c.left,this.madeFirstMove=!0),e.keyCode==39&&(this.currentMovingDirection==c.left&&(this.currentMovingDirection=c.right),this.requestedMovingDirection=c.right,this.madeFirstMove=!0)});this.x=e,this.y=t,this.tileSize=n,this.velocity=s,this.tileMap=o,this.currentMovingDirection=null,this.requestedMovingDirection=null,this.characterAnimationTimerDefault=10,this.characterAnimationTimer=null,this.characterRotation=this.Rotation.right,this.powerDotActive=!1,this.powerDotAboutToExpire=!1,this.timers=[],document.addEventListener("keydown",this.keydown),this.loadCharacterImages()}draw(e,t,n){t||(this.move(),this.animate()),this.eatDot();const s=this.tileSize;e.save(),e.translate(this.x+s,this.y+s),e.drawImage(this.characterImages[this.characterImageIndex],-s+this.CHARACTER_IMAGE_OFFSET_X,-s+this.CHARACTER_IMAGE_OFFSET_Y),e.restore()}loadCharacterImages(){const e=new Image;e.src=D;const t=new Image;t.src=D;const n=new Image;n.src=D;const s=new Image;s.src=D,this.characterImages=[e,t,n,s],this.characterImageIndex=0}move(){const e=Number.isInteger(this.x/this.tileSize)&&Number.isInteger(this.y/this.tileSize);if(this.currentMovingDirection!==this.requestedMovingDirection&&e){const o=Math.floor(this.x/this.tileSize)*this.tileSize,r=Math.floor(this.y/this.tileSize)*this.tileSize;this.tileMap.didCollideWithEnvironment(o,r,this.requestedMovingDirection)||(this.currentMovingDirection=this.requestedMovingDirection)}if(this.tileMap.didCollideWithEnvironment(this.x,this.y,this.currentMovingDirection)){this.characterAnimationTimer=null,this.characterImageIndex=1;return}this.currentMovingDirection!=null&&this.characterAnimationTimer==null&&(this.characterAnimationTimer=this.characterAnimationTimerDefault);const t=this.velocity;let n=this.x,s=this.y;for(let o=0;o<t;o++)if(!this.tileMap.didCollideWithEnvironment(n,s,this.currentMovingDirection))switch(this.currentMovingDirection){case c.up:s-=1;break;case c.down:s+=1;break;case c.left:n-=1;break;case c.right:n+=1;break}this.x=n,this.y=s}animate(){this.characterAnimationTimer!=null&&(this.characterAnimationTimer--,this.characterAnimationTimer===0&&(this.characterAnimationTimer=this.characterAnimationTimerDefault,this.characterImageIndex=(this.characterImageIndex+1)%this.characterImages.length))}eatDot(){this.tileMap.eatDot(this.x,this.y)}}const ue=""+new URL("zombie-a5b5dca1.svg",import.meta.url).href;class fe{constructor(e,t,n,s,o){a(this,"x");a(this,"y");a(this,"tileSize");a(this,"velocity");a(this,"tileMap");a(this,"movingDirection");a(this,"directionTimerDefault");a(this,"directionTimer");a(this,"scaredAboutToExpireTimerDefault");a(this,"scaredAboutToExpireTimer");a(this,"normalGhost");a(this,"scaredGhost");a(this,"scaredGhost2");a(this,"image");a(this,"directionChangeInterval",800);a(this,"lastDirectionChangeTime",0);this.x=e,this.y=t,this.tileSize=n,this.velocity=s,this.tileMap=o,this.loadImages(),this.movingDirection=Math.floor(Math.random()*Object.keys(c).length),this.directionTimerDefault=this.random(10,25),this.directionTimer=this.directionTimerDefault,this.scaredAboutToExpireTimerDefault=10,this.scaredAboutToExpireTimer=this.scaredAboutToExpireTimerDefault}draw(e,t){if(!t){const n=this.chooseDirectionBasedOnAdjacentCells();n!==this.movingDirection&&(this.movingDirection=n),this.move()}this.setImage(e)}collideWith(e){const t=this.tileSize/2;return this.x<e.x+t&&this.x+t>e.x&&this.y<e.y+t&&this.y+t>e.y}setImage(e){e.drawImage(this.image,this.x-5,this.y-20)}move(){const e=this.velocity;let t=this.x,n=this.y;for(let s=0;s<e;s++)if(!this.tileMap.didCollideWithEnvironment(t,n,this.movingDirection))switch(this.movingDirection){case c.up:n-=1;break;case c.down:n+=1;break;case c.left:t-=1;break;case c.right:t+=1;break}this.x=t,this.y=n}getCurrentCell(){const e=Math.floor(this.y/this.tileSize),t=Math.floor(this.x/this.tileSize);return{row:e,column:t}}getAdjacentCells(){const e=this.getCurrentCell(),t=[];return t.push({row:e.row-1,column:e.column}),t.push({row:e.row+1,column:e.column}),t.push({row:e.row,column:e.column-1}),t.push({row:e.row,column:e.column+1}),t}chooseDirectionBasedOnAdjacentCells(){const e=this.getCurrentCell(),t=this.getAdjacentCells(),n=Date.now();if(n-this.lastDirectionChangeTime>=this.directionChangeInterval){const s=[];for(const o of t){const r=this.tileMap.initialMap[o.row][o.column];if(r===0||r===5){const l=this.calculateDirectionToCell(e,o);s.push(l)}}if(Number.isInteger(this.x/this.tileSize)&&Number.isInteger(this.y/this.tileSize)&&s.length>0){const o=Math.floor(Math.random()*s.length),r=s[o];this.movingDirection=r,this.lastDirectionChangeTime=n}}return this.movingDirection}calculateDirectionToCell(e,t){return t.row<e.row?c.up:t.row>e.row?c.down:t.column<e.column?c.left:t.column>e.column?c.right:this.movingDirection}random(e,t){return Math.floor(Math.random()*(t-e+1))+e}loadImages(){this.normalGhost=new Image,this.normalGhost.src=ue,this.image=this.normalGhost}}const pe=[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,7,5,0,1,0,5,0,5,0,1,0,1,0,5,0,5,0,1,0,5,0,1,0,5,0,5,0,5,0,5,0,5,0,1],[1,5,1,5,1,5,1,1,1,5,1,5,1,1,1,5,1,5,1,1,1,5,1,1,1,5,1,1,1,1,1,1,1,1,1],[1,4,1,5,5,6,1,0,5,0,1,0,1,0,5,0,1,0,5,0,5,0,1,0,5,0,5,0,5,6,1,0,5,0,1],[1,1,1,1,1,5,1,5,1,1,1,5,1,5,1,1,1,1,1,5,1,1,1,5,1,1,1,1,1,5,1,5,1,1,1],[1,0,5,0,5,0,1,0,5,0,5,0,1,0,1,0,5,0,1,0,5,0,5,0,1,0,5,0,5,0,5,0,5,0,1],[1,5,1,1,1,5,1,5,1,1,1,5,1,5,1,1,1,5,1,5,1,1,1,5,1,1,1,5,1,5,1,1,1,5,1],[1,0,5,0,1,0,5,0,1,0,5,0,1,0,1,0,5,0,1,0,1,0,1,0,1,0,5,0,1,0,1,0,1,0,1],[1,1,1,5,1,5,1,1,1,5,1,1,1,5,1,5,1,1,1,5,1,5,1,5,1,5,1,1,1,5,1,5,1,5,1],[1,0,1,0,1,0,5,0,1,0,5,0,1,0,1,0,5,0,5,0,1,0,1,0,1,0,5,0,1,0,1,0,5,0,1],[1,5,1,5,1,5,1,1,1,1,1,5,1,5,1,5,5,5,5,5,1,5,1,5,1,5,1,5,1,5,1,1,1,1,1],[1,0,1,0,1,0,5,0,1,0,5,0,1,0,5,6,5,0,5,0,5,0,1,0,5,0,1,0,1,6,1,0,5,0,1],[1,5,1,5,1,1,1,5,1,5,1,1,1,5,1,5,5,5,5,5,1,1,1,5,1,5,1,5,1,5,1,5,1,5,1],[1,0,5,0,1,0,5,0,5,0,5,0,1,0,1,0,5,0,5,0,1,0,5,0,1,0,1,0,5,0,1,0,1,0,1],[1,5,1,1,1,1,1,1,1,5,1,5,1,5,1,1,1,1,1,5,1,5,1,5,1,1,1,5,1,5,1,5,1,5,1],[1,0,5,0,5,0,5,0,5,0,1,0,5,0,5,0,1,0,5,0,5,0,1,0,1,0,5,0,1,0,1,0,5,0,1],[1,1,1,1,1,5,1,1,1,1,1,5,1,1,1,5,1,5,1,1,1,1,1,5,1,1,1,1,1,5,1,1,1,5,1],[1,0,5,0,1,6,1,0,5,0,5,0,5,0,1,0,5,0,5,0,5,0,5,0,5,0,5,0,1,0,5,0,5,0,1],[1,5,1,5,1,5,1,5,1,1,1,1,1,1,1,1,1,1,1,5,1,1,1,1,1,1,1,5,1,5,1,1,1,1,1],[1,0,1,0,5,0,5,0,1,0,1,0,1,0,5,0,5,0,5,0,1,0,5,0,5,0,5,0,5,0,5,0,5,0,1],[1,5,1,1,1,1,1,5,1,5,1,5,1,1,1,5,1,1,1,1,1,5,1,1,1,1,1,1,1,1,1,5,1,5,1],[1,0,5,0,5,0,1,0,1,0,1,0,5,0,5,0,5,0,1,0,5,6,5,0,5,0,5,0,1,0,5,0,1,0,1],[1,1,1,5,1,1,1,5,1,5,1,5,1,1,1,1,1,5,1,1,1,1,1,5,1,1,1,1,1,5,1,1,1,5,1],[1,0,5,0,5,0,5,0,5,0,5,0,1,0,5,0,5,0,5,0,5,0,1,0,5,0,5,0,5,0,5,0,5,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],ge=[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,7,5,0,1,0,5,0,5,0,1,0,1,0,5,0,5,0,1,0,5,0,1,0,5,0,5,0,5,0,5,0,5,0,1],[1,5,1,5,1,5,1,1,1,5,1,5,1,1,1,5,1,5,1,1,1,5,1,1,1,5,1,1,1,1,1,1,1,1,1],[1,4,1,5,5,0,1,0,5,0,1,0,1,6,5,0,1,0,5,0,5,0,1,0,5,0,5,0,5,0,1,6,5,0,1],[1,1,1,1,1,5,1,5,1,1,1,5,1,5,1,1,1,1,1,5,1,1,1,5,1,1,1,1,1,5,1,5,1,1,1],[1,0,5,0,5,6,1,0,5,0,5,0,1,0,1,0,5,0,1,0,5,0,5,0,1,0,5,0,5,0,5,0,5,0,1],[1,5,1,1,1,5,1,5,1,1,1,5,1,5,1,1,1,5,1,5,1,1,1,5,1,1,1,5,1,5,1,1,1,5,1],[1,0,5,0,1,0,5,0,1,0,5,0,1,0,1,0,5,0,1,0,1,0,1,0,1,0,5,6,1,0,1,0,1,0,1],[1,1,1,5,1,5,1,1,1,5,1,1,1,5,1,5,1,1,1,5,1,5,1,5,1,5,1,1,1,5,1,5,1,5,1],[1,0,1,0,1,0,5,0,1,0,5,0,1,0,1,0,5,0,5,0,1,0,1,0,1,0,5,0,1,0,1,0,5,0,1],[1,5,1,5,1,5,1,1,1,1,1,5,1,5,1,5,5,5,5,5,1,5,1,5,1,5,1,5,1,5,1,1,1,1,1],[1,6,1,0,1,0,5,0,1,0,5,0,1,0,5,0,5,0,5,0,5,0,1,0,5,0,1,0,1,0,1,0,5,0,1],[1,5,1,5,1,1,1,5,1,5,1,1,1,5,1,5,5,5,5,5,1,1,1,5,1,5,1,5,1,5,1,5,1,5,1],[1,0,5,0,1,0,5,6,5,0,5,0,1,0,1,0,5,0,5,0,1,0,5,6,1,0,1,0,5,0,1,0,1,0,1],[1,5,1,1,1,1,1,1,1,5,1,5,1,5,1,1,1,1,1,5,1,5,1,5,1,1,1,5,1,5,1,5,1,5,1],[1,0,5,0,5,0,5,0,5,0,1,0,5,0,5,0,1,0,5,0,5,0,1,0,1,0,5,0,1,0,1,0,5,0,1],[1,1,1,1,1,5,1,1,1,1,1,5,1,1,1,5,1,5,1,1,1,1,1,5,1,1,1,1,1,5,1,1,1,5,1],[1,0,5,0,1,0,1,0,5,0,5,0,5,0,1,0,5,0,5,0,5,0,5,0,5,6,5,0,1,0,5,0,5,0,1],[1,5,1,5,1,5,1,5,1,1,1,1,1,1,1,1,1,1,1,5,1,1,1,1,1,1,1,5,1,5,1,1,1,1,1],[1,0,1,0,5,6,5,0,1,0,1,0,1,0,5,0,5,0,5,0,1,0,5,0,5,0,5,0,5,0,5,0,5,0,1],[1,5,1,1,1,1,1,5,1,5,1,5,1,1,1,5,1,1,1,1,1,5,1,1,1,1,1,1,1,1,1,5,1,5,1],[1,0,5,0,5,0,1,0,1,0,1,0,5,0,5,0,5,0,1,0,5,6,5,0,5,0,5,0,1,0,5,0,1,0,1],[1,1,1,5,1,1,1,5,1,5,1,5,1,1,1,1,1,5,1,1,1,1,1,5,1,1,1,1,1,5,1,1,1,5,1],[1,0,5,0,5,0,5,0,5,0,5,0,1,0,5,0,5,0,5,0,5,0,1,0,5,0,5,0,5,0,5,0,5,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],ve=[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,7,5,0,1,0,5,0,5,0,1,0,1,0,5,0,5,0,1,0,5,0,1,0,5,0,5,0,5,0,5,0,5,0,1],[1,5,1,5,1,5,1,1,1,5,1,5,1,1,1,5,1,5,1,1,1,5,1,1,1,5,1,1,1,1,1,1,1,1,1],[1,4,1,5,5,0,1,0,5,0,1,0,1,6,5,0,1,0,5,0,5,0,1,6,5,0,5,0,5,0,1,6,5,0,1],[1,1,1,1,1,5,1,5,1,1,1,5,1,5,1,1,1,1,1,5,1,1,1,5,1,1,1,1,1,5,1,5,1,1,1],[1,0,5,0,5,6,1,0,5,0,5,0,1,0,1,0,5,0,1,0,5,0,5,0,1,0,5,0,5,0,5,0,5,0,1],[1,5,1,1,1,5,1,5,1,1,1,5,1,5,1,1,1,5,1,5,1,1,1,5,1,1,1,5,1,5,1,1,1,5,1],[1,0,5,0,1,0,5,0,1,0,5,0,1,0,1,0,5,0,1,0,1,0,1,0,1,0,5,6,1,0,1,0,1,0,1],[1,1,1,5,1,5,1,1,1,5,1,1,1,5,1,5,1,1,1,5,1,5,1,5,1,5,1,1,1,5,1,5,1,5,1],[1,0,1,0,1,0,5,0,1,0,5,0,1,0,1,0,5,0,5,0,1,0,1,0,1,0,5,0,1,0,1,0,5,0,1],[1,5,1,5,1,5,1,1,1,1,1,5,1,5,1,5,5,5,5,5,1,5,1,5,1,5,1,5,1,5,1,1,1,1,1],[1,6,1,0,1,0,5,0,1,0,5,0,1,0,5,6,5,0,5,0,5,0,1,0,5,0,1,0,1,0,1,0,5,0,1],[1,5,1,5,1,1,1,5,1,5,1,1,1,5,1,5,5,5,5,5,1,1,1,5,1,5,1,5,1,5,1,5,1,5,1],[1,0,5,0,1,0,5,6,5,0,5,0,1,0,1,0,5,0,5,0,1,0,5,6,1,0,1,0,5,0,1,0,1,0,1],[1,5,1,1,1,1,1,1,1,5,1,5,1,5,1,1,1,1,1,5,1,5,1,5,1,1,1,5,1,5,1,5,1,5,1],[1,0,5,0,5,0,5,0,5,0,1,0,5,0,5,0,1,0,5,0,5,0,1,0,1,0,5,0,1,0,1,0,5,0,1],[1,1,1,1,1,5,1,1,1,1,1,5,1,1,1,5,1,5,1,1,1,1,1,5,1,1,1,1,1,5,1,1,1,5,1],[1,0,5,0,1,0,1,0,5,0,5,0,5,0,1,0,5,0,5,0,5,0,5,0,5,6,5,0,1,0,5,6,5,0,1],[1,5,1,5,1,5,1,5,1,1,1,1,1,1,1,1,1,1,1,5,1,1,1,1,1,1,1,5,1,5,1,1,1,1,1],[1,0,1,0,5,6,5,0,1,0,1,0,1,0,5,0,5,0,5,0,1,0,5,0,5,0,5,0,5,0,5,0,5,0,1],[1,5,1,1,1,1,1,5,1,5,1,5,1,1,1,5,1,1,1,1,1,5,1,1,1,1,1,1,1,1,1,5,1,5,1],[1,0,5,0,5,0,1,0,1,0,1,0,5,0,5,0,5,0,1,0,5,6,5,0,5,0,5,0,1,0,5,0,1,0,1],[1,1,1,5,1,1,1,5,1,5,1,5,1,1,1,1,1,5,1,1,1,1,1,5,1,1,1,1,1,5,1,1,1,5,1],[1,0,5,0,5,0,5,0,5,0,5,0,1,0,5,0,5,0,5,0,5,0,1,0,5,0,5,0,5,0,5,0,5,6,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],A={Easy:{speed:1,map:pe},Medium:{speed:1.2,map:ge},Hard:{speed:1.5,map:ve}};class xe{constructor(e,t,n){a(this,"tileSize");a(this,"silverDot");a(this,"goldDot");a(this,"wall");a(this,"map");a(this,"initialMap");a(this,"collectedCoins",[]);a(this,"coinEaten");a(this,"coinType",null);a(this,"canvas");a(this,"coinBuffer",null);this.tileSize=e,this.canvas=t,this.silverDot=new Image,this.silverDot.src=E,this.goldDot=new Image,this.goldDot.src=N,this.coinEaten=!1,this.coinType=null,this.map=A[n].map,this.initialMap=this.map.map(s=>s.slice())}loadImages(){const e=new Promise(n=>{this.silverDot.onload=n}),t=new Promise(n=>{this.goldDot.onload=n});return this.silverDot.src=E,this.goldDot.src=N,Promise.all([e,t])}async initialize(){await this.loadImages(),this.createCoinBuffer()}resetMap(){this.map=this.initialMap.map(e=>e.slice())}createCoinBuffer(){this.coinBuffer||(this.coinBuffer=document.createElement("canvas")),this.coinBuffer.width=this.canvas.width||0,this.coinBuffer.height=this.canvas.height||0;const e=this.coinBuffer.getContext("2d");if(e){e.clearRect(0,0,this.coinBuffer.width,this.coinBuffer.height);for(let t=0;t<this.initialMap.length;t++)for(let n=0;n<this.initialMap[t].length;n++){const s=this.initialMap[t][n];s===0?this.drawSilverDot(e,n,t):s===7&&this.drawGoldDot(e,n,t)}}}draw(e){this.coinBuffer&&e.drawImage(this.coinBuffer,0,0),this.collectedCoins.forEach(({row:t,column:n})=>{this.initialMap[t][n]=5})}drawSilverDot(e,t,n){const s=this.tileSize,o=t*s+s/2-this.silverDot.width/2,r=n*s+s/2-this.silverDot.height/2;e.drawImage(this.silverDot,o,r,s,s)}drawGoldDot(e,t,n){const s=this.tileSize,o=t*s,r=n*s;e.drawImage(this.goldDot,o,r,s,s)}getCharacter(e){for(let t=0;t<this.initialMap.length;t++)for(let n=0;n<this.initialMap[t].length;n++)if(this.initialMap[t][n]===4)return this.initialMap[t][n]=5,new de(n*this.tileSize,t*this.tileSize,this.tileSize,e,this)}getEnemies(e){const t=[];for(let n=0;n<this.initialMap.length;n++)for(let s=0;s<this.initialMap[n].length;s++)this.initialMap[n][s]===6&&(this.initialMap[n][s]=0,t.push(new fe(s*this.tileSize,n*this.tileSize,this.tileSize,e,this)),this.createCoinBuffer());return t}setCanvasSize(e){if(!e)throw new Error("Missing canvas argument");e.width=this.initialMap[0].length*this.tileSize,e.height=this.initialMap.length*this.tileSize}didCollideWithEnvironment(e,t,n){if(n===null)return!1;if(Number.isInteger(e/this.tileSize)&&Number.isInteger(t/this.tileSize)){let s=0,o=0,r=0,l=0;switch(n){case c.right:r=e+this.tileSize,s=r/this.tileSize,o=t/this.tileSize;break;case c.left:r=e-this.tileSize,s=r/this.tileSize,o=t/this.tileSize;break;case c.up:l=t-this.tileSize,o=l/this.tileSize,s=e/this.tileSize;break;case c.down:l=t+this.tileSize,o=l/this.tileSize,s=e/this.tileSize;break}return this.initialMap[o][s]===1}return!1}didWin(){return this.dotsLeft()===0}dotsLeft(){return this.initialMap.flat().filter(e=>e===0).length}eatDot(e,t){const n=this.tileSize,s=Math.floor(t/n),o=Math.floor(e/n),r={0:"silver",7:"gold"};if(s>=0&&s<this.initialMap.length&&o>=0&&o<this.initialMap[0].length){const l=this.initialMap[s][o],m=r[l];if(m)return this.coinType=m,this.coinEaten=!0,this.collectedCoins.push({row:s,column:o,type:m}),this.removeCollectedCoin(s,o),!0}return this.coinEaten=!1,!1}updateCoinBuffer(e,t){if(!this.coinBuffer)return;const n=this.coinBuffer.getContext("2d");if(!n)return;const s=this.tileSize,o=e*s,r=t*s,l=this.initialMap[t][e];n.clearRect(o,r,s,s),l===0?this.drawSilverDot(n,e,t):l===7&&this.drawGoldDot(n,e,t)}removeCollectedCoin(e,t){this.collectedCoins=this.collectedCoins.filter(n=>n.row!==e||n.column!==t),this.initialMap[e][t]=5,this.updateCoinBuffer(t,e)}isCoinEaten(){return this.coinEaten}getCoinEaten(){return this.coinType}}class Ce{constructor(e,t,n,s){a(this,"TILE_SIZE",32);a(this,"canvas");a(this,"tileMap");a(this,"character");a(this,"enemies",[]);a(this,"gameActions");a(this,"isStopGame");a(this,"timer");a(this,"timerInterval",null);a(this,"animationId",null);this.canvas=e,this.tileMap=new xe(this.TILE_SIZE,e,s),this.tileMap.initialize().then(()=>{this.character=this.tileMap.getCharacter(A[s].speed),this.enemies=[],this.enemies=this.tileMap.getEnemies(A[s].speed)}),this.gameActions=t,this.isStopGame=!1,this.timer=n,this.timerInterval=setInterval(()=>{this.timer-=1},1e3)}startGameLoop(){if(!this.animationId){const e=()=>{this.isStopGame||(this.gameLoop(),this.animationId=requestAnimationFrame(e))};this.animationId=requestAnimationFrame(e)}}stopGameLoop(){this.animationId&&(cancelAnimationFrame(this.animationId),this.animationId=null)}gameStart(){this.isStopGame=!1,this.startGameLoop()}gameOver(){this.isStopGame=!0,this.stopGameLoop()}gameLoop(){if(this.canvas){const e=this.canvas.getContext("2d");if(!e||!this.character)return;if(e.imageSmoothingEnabled=!1,e.clearRect(0,0,this.canvas.width,this.canvas.height),this.tileMap.draw(e),this.character.draw(e,this.pause(),this.enemies),this.enemies.forEach(t=>t.draw(e,this.pause())),this.drawGameEnd(),this.tileMap&&this.tileMap.isCoinEaten()){const t=this.tileMap.getCoinEaten();t&&this.gameActions.incrementCoins(t)}}}endGame(e){this.clearTimerInterval(),cancelAnimationFrame(e)}setPause(e){this.isStopGame=e}pause(){return this.isStopGame}drawGameEnd(){(this.enemies.some(t=>t.collideWith(this.character))||this.timer<=0||this.tileMap.didWin())&&(this.setPause(!0),this.gameActions.setGameOver(!0),this.clearTimerInterval())}setCanvasSize(){this.canvas&&this.tileMap.setCanvasSize(this.canvas)}clearTimerInterval(){this.timerInterval&&(clearInterval(this.timerInterval),this.timerInterval=null)}}const we=""+new URL("avatar-93683478.png",import.meta.url).href,Se=""+new URL("total-coins-40c5acb3.svg",import.meta.url).href,Me="_canvas_1lubo_1",je="_modalOverlay_1lubo_10",be="_modalContent_1lubo_23",ye="_avatar_1lubo_32",_e="_close_1lubo_38",De="_info_1lubo_44",Ie="_title_1lubo_47",Te="_fontSemibold_1lubo_54",Ne="_total_1lubo_57",Ee="_coins_1lubo_63",ke="_totalTokens_1lubo_73",ze="_number_1lubo_79",Ae="_buttons_1lubo_88",v={canvas:Me,modalOverlay:je,modalContent:be,avatar:ye,close:_e,info:De,title:Ie,fontSemibold:Te,total:Ne,coins:Ee,totalTokens:ke,number:ze,buttons:Ae},Ge=(h,e)=>{const{tokensPerGoldCoinEasy:t,tokensPerSilverCoinEasy:n,tokensPerGoldCoinMedium:s,tokensPerSilverCoinMedium:o,tokensPerGoldCoinHard:r,tokensPerSilverCoinHard:l}=h,m={Easy:t,Medium:s,Hard:r},f={Easy:n,Medium:o,Hard:l};return{tokensPerGoldCoin:Number(m[e]),tokensPerSilverCoin:Number(f[e])}},Be=({setOpenModal:h})=>{const{configState:e,game:t}=I(),{onClaimReward:n,isPending:s}=Q(),{allPlayers:o}=I(),{api:r}=J(),[l]=(r==null?void 0:r.registry.chainTokens)||["TVARA"],{silverCoins:m,goldCoins:f}=d.useContext(k),u=e&&t&&Ge(e,t.level),[g,p]=d.useState(0),x=(u==null?void 0:u.tokensPerGoldCoin)||0,w=(u==null?void 0:u.tokensPerSilverCoin)||0,M=f*x,j=m*w,[z,G]=d.useState(!1);d.useEffect(()=>{p(j+M)},[]);const O=()=>{n(m,f)},H=()=>{G(!z)};if(z){const W=o?o.slice().sort((U,q)=>{const[Le,B]=U,[Fe,P]=q,V=B.claimedGoldCoins+B.claimedSilverCoins;return P.claimedGoldCoins+P.claimedSilverCoins-V}):[];return i.jsx(F,{setIsOpen:G,isOpen:z,players:W})}return i.jsx("div",{className:v.modalContain,children:i.jsx("div",{className:v.modalOverlay,children:i.jsxs("div",{className:v.modalContent,children:[i.jsx("div",{className:v.avatar,children:i.jsx("img",{width:100,src:we,alt:""})}),i.jsx("div",{className:v.close,onClick:()=>h(!1),children:i.jsx(R,{})}),i.jsxs("div",{className:v.info,children:[i.jsxs("div",{className:v.title,children:[i.jsx("span",{className:"font-semibold",children:"Dead mouse,"}),i.jsx("span",{className:"font-semibold text-[#2BD071]",children:"Congratulations!"}),i.jsx("span",{className:"font-extralight",children:"Your reward"})]}),i.jsxs("div",{className:v.total,children:[i.jsxs("div",{className:v.coins,children:[i.jsx("img",{src:E,width:24,alt:""}),i.jsxs("span",{className:"font-semibold",children:[m," x ",w," = ",j," "]}),i.jsx("span",{className:"font-extralight",children:l})]}),i.jsxs("div",{className:v.coins,children:[i.jsx("img",{src:N,width:24,alt:""}),i.jsxs("span",{className:"font-semibold",children:[f," x ",x," = ",M," "]}),i.jsx("span",{className:"font-extralight",children:l})]})]}),i.jsxs("div",{className:v.totalTokens,children:[i.jsx("img",{src:Se,alt:""}),i.jsxs("div",{className:v.number,children:[i.jsx("span",{className:"font-medium text-[40px]",children:g}),i.jsx("span",{className:"font-light italic text-[16px]",children:l})]})]}),i.jsxs("div",{className:v.buttons,children:[i.jsx("button",{className:S("btn",T.primary,s&&"btn--loading"),onClick:O,disabled:s,children:i.jsx("span",{children:"Claim reward"})}),i.jsx("button",{className:S("btn",T.lightGreen),onClick:H,children:i.jsx("span",{children:"Show champions"})})]})]})]})})})},Pe=()=>{const{incrementCoins:h,gameTime:e,level:t}=d.useContext(k),n=d.useRef(null),[s,o]=d.useState(!1),[r,l]=d.useState(!1);return d.useEffect(()=>{const m=n.current,f={incrementCoins:h,setGameOver:o};if(m&&!s){const u=new Ce(m,f,e,t);return u.setCanvasSize(),u.startGameLoop(),()=>{u.stopGameLoop()}}s&&l(!0)},[s]),d.useEffect(()=>{const m=f=>{[37,38,39,40].includes(f.keyCode)&&f.preventDefault()};return document.addEventListener("keydown",m),()=>{document.removeEventListener("keydown",m)}},[]),i.jsx(i.Fragment,{children:i.jsxs("div",{className:v.canvas,children:[r&&i.jsx(Be,{setOpenModal:l}),i.jsx("canvas",{ref:n,id:"gameCanvas"})]})})};function Re({}){return i.jsx("div",{children:i.jsxs(ee,{children:[i.jsx(me,{}),i.jsx(Pe,{})]})})}function qe(){return i.jsx(i.Fragment,{children:i.jsx(Re,{})})}export{qe as default};
